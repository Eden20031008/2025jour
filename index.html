<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>踩地雷！</title>
<style>
  body {
    background: #1E3A8A;
    font-family: sans-serif;
    text-align: center;
    padding: 20px;
    color: #fff;
  }

  h1 {
    margin-bottom: 20px;
  }

  .board {
    display: grid;
    grid-template-columns: repeat(10, 30px);
    grid-gap: 2px;
    justify-content: center;
  }

  .cell {
    width: 30px;
    height: 30px;
    background: #E0F2FE;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
    color: #333;
    line-height: 30px;
    user-select: none;
  }

  .cell.revealed {
    background: #fff;
    cursor: default;
  }

  .cell.mine {
    background: red;
    color: #fff;
  }
</style>
</head>
<body>

<h1>💣 踩地雷遊戲 💣</h1>
<div class="board" id="board"></div>

<script>
  const boardSize = 10;
  const mineCount = 15;
  const board = document.getElementById('board');

  let cells = [];

  function createBoard() {
    cells = [];
    board.innerHTML = '';
    for (let i = 0; i < boardSize * boardSize; i++) {
      let cell = document.createElement('div');
      cell.classList.add('cell');
      cell.dataset.index = i;
      board.appendChild(cell);
      cells.push(cell);
    }
    placeMines();
    cells.forEach(cell => cell.addEventListener('click', revealCell));
  }

  function placeMines() {
    let minesPlaced = 0;
    while (minesPlaced < mineCount) {
      let index = Math.floor(Math.random() * cells.length);
      if (!cells[index].classList.contains('mine')) {
        cells[index].classList.add('mine');
        minesPlaced++;
      }
    }
  }

  function revealCell(e) {
    const cell = e.target;
    if (cell.classList.contains('revealed')) return;
    cell.classList.add('revealed');

    if (cell.classList.contains('mine')) {
      cell.innerText = '💣';
      alert("你踩到地雷啦！");
      revealAll();
      return;
    }

    let index = parseInt(cell.dataset.index);
    let neighbors = getNeighbors(index);
    let mineCount = neighbors.filter(i => cells[i].classList.contains('mine')).length;
    if (mineCount > 0) {
      cell.innerText = mineCount;
    } else {
      neighbors.forEach(i => revealCell({target: cells[i]}));
    }
  }

  function getNeighbors(index) {
    const neighbors = [];
    const x = index % boardSize;
    const y = Math.floor(index / boardSize);

    for (let dx = -1; dx <= 1; dx++) {
      for (let dy = -1; dy <= 1; dy++) {
        if (dx === 0 && dy === 0) continue;
        let nx = x + dx;
        let ny = y + dy;
        if (nx >= 0 && nx < boardSize && ny >= 0 && ny < boardSize) {
          neighbors.push(ny * boardSize + nx);
        }
      }
    }
    return neighbors;
  }

  function revealAll() {
    cells.forEach(cell => {
      cell.classList.add('revealed');
      if (cell.classList.contains('mine')) {
        cell.innerText = '💣';
      }
    });
  }

  createBoard();
</script>

</body>
</html>
